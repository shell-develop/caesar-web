(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15685ace"],{"22fc":function(e,t,a){},6447:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[[a("div",[a("h1",[e._v("任务查询")])]),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("ServerTaskTable",{on:{previewTask:e.handlerPreviewTask}})],1),a("el-col",{attrs:{span:12}},[a("AnsibleResult",{ref:"ansibleResult"})],1)],1)]],2)},r=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticStyle:{"margin-bottom":"5px","margin-left":"0px"},attrs:{gutter:24}},[a("el-select",{attrs:{clearable:"",placeholder:"类型"},model:{value:e.queryParam.taskType,callback:function(t){e.$set(e.queryParam,"taskType","string"===typeof t?t.trim():t)},expression:"queryParam.taskType"}},e._l(e.taskTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:e.fetchData}},[e._v("查询")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"user",label:"用户"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!==t.row.user&&null!==t.row.user.displayName?a("span",[e._v(e._s(t.row.user.displayName))]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"taskType",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{"disable-transitions":""}},[e._v(e._s(e._f("getServerTaskText")(t.row.taskType)))])]}}])}),a("el-table-column",{attrs:{prop:"taskSize",label:"机器数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{"disable-transitions":""}},[e._v(e._s(t.row.taskSize))])]}}])}),a("el-table-column",{attrs:{prop:"finalized",label:"完成"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1===t.row.finalized?"success":"danger","disable-transitions":""}},[e._v(e._s(1===t.row.finalized?"完成":"进行")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"ago",label:"时间"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return e.handlerPreview(t.row)}}},[e._v("详情")])]}}])})],1),a("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize},on:{"current-change":e.paginationCurrentChange,"size-change":e.handleSizeChange}})],1)},s=[],o=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),l=a("5880");function u(e){switch(e){case 0:return"Cmd";case 1:return"Script";case 2:return"Playbook";default:return"未定义"}}var c=a("67ee");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=[{value:0,label:"批量命令"},{value:1,label:"批量脚本"},{value:2,label:"Playbook"}],b={name:"ServerTaskTable",data:function(){return{tableData:[],loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{userId:"",taskType:""},taskTypeOptions:d,title:"历史任务查询"}},filters:{getServerTaskText:u},computed:f({},Object(l["mapState"])("d2admin/user",["info"])),mounted:function(){this.initPageSize(),this.fetchData()},components:{},methods:f({},Object(l["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(e){this.pagination.pageSize=e,this.info.pageSize=e,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},handlerPreview:function(e){this.$emit("previewTask",e.id)},fetchData:function(){var e=this;this.loading=!0;var t=Object.assign({},this.queryParam);t.page=this.pagination.currentPage,t.length=this.pagination.pageSize,Object(c["p"])(t).then((function(t){e.tableData=t.body.data,e.pagination.total=t.body.totalNum,e.loading=!1}))}})},g=b,h=(a("d9ac"),a("2877")),y=function(e){e.options.__source="src/components/opscloud/ansible/ServerTaskTable.vue"},v=y,m=Object(h["a"])(g,i,s,!1,null,"6d3d49e7",null);"function"===typeof v&&v(m);var k=m.exports,S=a("ebec"),w={data:function(){return{serverTask:"",taskId:""}},mounted:function(){},components:{ServerTaskTable:k,AnsibleResult:S["a"]},methods:{handlerPreviewTask:function(e){this.$refs.ansibleResult.initData(e)}}},P=w,_=function(e){e.options.__source="src/pages/task/history/index.vue"},O=_,T=Object(h["a"])(P,n,r,!1,null,null,null);"function"===typeof O&&O(T);t["default"]=T.exports},d9ac:function(e,t,a){"use strict";var n=a("22fc"),r=a.n(n);r.a}}]);